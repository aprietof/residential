
var geocoder;var map;var selected_id="";var gmarkers=[];function initialize(){geocoder=new google.maps.Geocoder();var d=jQuery("#property_latitude").val();var e=jQuery("#property_longitude").val();if(d===""){d=google_map_submit_vars.general_latitude}if(e===""){e=google_map_submit_vars.general_longitude}var b={flat:false,noClear:false,zoom:17,scrollwheel:false,draggable:true,disableDefaultUI:false,center:new google.maps.LatLng(d,e),mapTypeId:google.maps.MapTypeId.ROADMAP};if(document.getElementById("googleMapsubmit")){map=new google.maps.Map(document.getElementById("googleMapsubmit"),b)}else{return}google.maps.visualRefresh=true;var a=new google.maps.LatLng(d,e);placeSavedMarker(a);if(mapfunctions_vars.map_style!==""){var c=JSON.parse(mapfunctions_vars.map_style);map.setOptions({styles:c})}google.maps.event.addListener(map,"click",function(f){placeMarker(f.latLng)})}function placeSavedMarker(b){removeMarkers();var a=new google.maps.Marker({position:b,map:map});gmarkers.push(a);var c=new google.maps.InfoWindow({content:"Latitude: "+b.lat()+"<br>Longitude: "+b.lng()});c.open(map,a)}function codeAddress(){var a=document.getElementById("property_address").value;city=jQuery("#property_city_submit").val();var b=a+","+city;var c=document.getElementById("property_county").value;if(c){var b=b+","+c}var d=document.getElementById("property_country").value;if(d){var b=b+","+d}geocoder.geocode({address:b},function(g,f){if(f==google.maps.GeocoderStatus.OK){map.setCenter(g[0].geometry.location);var e=new google.maps.Marker({map:map,position:g[0].geometry.location});gmarkers.push(e);var h=new google.maps.InfoWindow({content:"Latitude: "+g[0].geometry.location.lat()+"<br>Longitude: "+g[0].geometry.location.lng()});h.open(map,e);document.getElementById("property_latitude").value=g[0].geometry.location.lat();document.getElementById("property_longitude").value=g[0].geometry.location.lng()}else{alert(google_map_submit_vars.geo_fails+f)}})}function placeMarker(b){removeMarkers();var a=new google.maps.Marker({position:b,map:map});gmarkers.push(a);var c=new google.maps.InfoWindow({content:"Latitude: "+b.lat()+"<br>Longitude: "+b.lng()});c.open(map,a);document.getElementById("property_latitude").value=b.lat();document.getElementById("property_longitude").value=b.lng()}function removeMarkers(){for(i=0;i<gmarkers.length;i++){gmarkers[i].setMap(null)}}function setMarkers(b,a){}jQuery("#open_google_submit").click(function(){setTimeout(function(){initialize();google.maps.event.trigger(map,"resize")},300)});jQuery("#google_capture").click(function(a){a.preventDefault();removeMarkers();codeAddress()});google.maps.event.addDomListener(window,"load",initialize);jQuery(document).ready(function(h){h("#imagelist").sortable({revert:true,update:function(l,m){var k,j;k="";h("#imagelist .uploaded_images").each(function(){j=h(this).attr("data-imageid");if(typeof j!="undefined"){k=k+","+j}});h("#attachid").val(k)},});var g,f;var d={types:["(cities)"],componentRestrictions:{country:"uk"}};var e={establishment:"long_name",street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"long_name",administrative_area_level_2:"long_name",country:"long_name",postal_code:"short_name",postal_code_prefix:"short_name",neighborhood:"long_name"};if(google_map_submit_vars.enable_auto==="yes"){if(document.getElementById("property_address")){g=new google.maps.places.Autocomplete((document.getElementById("property_address")),{types:["geocode"],partial_match:true});var c=document.getElementById("property_address");google.maps.event.addDomListener(c,"keydown",function(j){if(j.keyCode==13){j.stopPropagation();j.preventDefault()}});google.maps.event.addListener(g,"place_changed",function(k){var j=g.getPlace();a(j)});f=new google.maps.places.Autocomplete((document.getElementById("property_city_submit")),{types:["(cities)"]});google.maps.event.addListener(f,"place_changed",function(){var j=f.getPlace();a(j)})}}function a(j){h("#property_area").val("");h("#property_zip").val("");h("#property_county").val("");h("#property_city_submit").val("");for(var m=0;m<j.address_components.length;m++){var l=j.address_components[m].types[0];var k="";var n=j.address_components[m][e[l]];if(l==="street_number"||l==="route"){}else{if(l==="neighborhood"){h("#property_area").val(n)}else{if(l==="postal_code_prefix"){h("#property_zip").val(n)}else{if(l==="postal_code"){h("#property_zip").val(n)}else{if(l==="administrative_area_level_2"){h("#property_county").val(n)}else{if(l==="administrative_area_level_1"){h("#property_county").val(n)}else{if(l==="locality"){h("#property_city_submit").val(n)}else{if(l==="country"){h("#property_country").val(n)}else{}}}}}}}}}}jQuery("#google_capture2").click(function(j){j.preventDefault();b()});function b(){var j=document.getElementById("property_address").value;var n=jQuery("#property_city_submit").val();var k=j+","+n;if(document.getElementById("property_state")){var l=document.getElementById("property_state").value;if(l){var k=k+","+l}}if(document.getElementById("property_country")){var m=document.getElementById("property_country").value;if(m){var k=k+","+m}}geocoder.geocode({address:k},function(q,p){if(p==google.maps.GeocoderStatus.OK){map.setCenter(q[0].geometry.location);var o=new google.maps.Marker({map:map,position:q[0].geometry.location});var r=new google.maps.InfoWindow({content:"Latitude: "+q[0].geometry.location.lat()+"<br>Longitude: "+q[0].geometry.location.lng()});r.open(map,o);document.getElementById("property_latitude").value=q[0].geometry.location.lat();document.getElementById("property_longitude").value=q[0].geometry.location.lng()}else{alert(google_map_submit_vars.geo_fails+p)}})}});